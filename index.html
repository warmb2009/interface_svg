<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>机柜管理</title>
    <script src="./static/d3.v5.min.js"></script>
    <style>
      .body {
	  display: table;
	  background-color: green;
      }

      .left-side {
	  background-color: blue;
	  float: none;
	  display: table-cell;
	  border: 1px solid;
      }

      .right-side {
	  background-color: red;
	  float: none;
	  display: table-cell;
	  border: 1px solid;
      }
    </style>
  </head>
  <body>
    <div style="background:lightgrey; border:1px solid grey;">
      <svg preserveAspectRatio="" viewBox="0 0 300 300">
	<rect width="100%" height="100%" fill="black" />
      </svg>

      <script>
	//d3 zoom
	var zoom = d3.zoom()
	    .scaleExtent([0.01,10])
	    .on("zoom", zoomed);
	
	function zoomed() {
	    d3.select('#g_object').attr("transform", d3.event.transform);
	}

	
	var length = 42;

	var title_width = 240;
	var title_height = 30;
	var title_color = 'dimgray';
	
	var u_width = title_width * 8 / 10;
	var u_height = u_width / 443 * 43.5;
	
	var object_x = 0, object_y = 0;
	
	var svg = d3.select("svg");
	var width = svg.attr("width");
	var height = svg.attr("height");

	// 主要框架
	var g_main = svg.append("g")
	    .attr('id', 'g_main')
	    .attr('transform', 'translate(0, 0)');
	svg.call(zoom);

	
	//主要框架内 加入三个左 中 右框架
	var g_left = g_main.append('g');
	var g_center = g_main.append('g');
	var g_right = g_main.append('g').attr("id", "g_view");


	
	//左侧
	g_left.attr('width', '100');
	g_left.attr('height', '2000');

	//中间
	g_center.attr('width', '100');
	g_center.attr('height', '2000');
	
	//右侧窗口
	g_right.attr('width', '2000')
    .attr('height', '2000')


	//设定背景  加入rect
	g_left.append('rect')
    .attr('width', '100%')
    .attr('height', '100%')
    .attr('fill', 'red');

	g_center.append('rect')
    .attr('width', '100%')
    .attr('height', '100%')
    .attr('fill', 'green');

	g_right.append('rect')
    .attr('width', '100%')
    .attr('height', '100%')
    .attr('fill', 'yellow');

	var g = g_right.append('g').attr('id', 'g_object');
	//svg.call(zoom);
	// 机柜名称部分
	g.append('rect').attr('width', title_width / 10 - 2)
    .attr('height', title_height)
    .attr('fill', title_color)
    .attr('x', object_x)
    .attr('y', object_y); //左边小格
	g.append('rect').attr('width', title_width / 10 * 8)
    .attr('height', title_height)
    .attr('fill', title_color)
    .attr('x', title_width / 10 + object_x)
    .attr('y', object_y);
	g.append('rect').attr('width', title_width / 10 - 2)
    .attr('height', title_height)
    .attr('fill', title_color)
    .attr('x', 9 * title_width / 10 + 2 + object_x)
    .attr('y', object_y);
	
	var text = g.append('text').text('图腾机柜')
	    .attr('fill', 'white')
	    .attr('x', title_width / 2)
	    .attr('y', title_height / 2)
	    .attr('text-anchor', 'middle')
	    .attr('font-size', title_height / 2 + 'px')
	    .attr('dy', 8)

	//画背景, 在背景之上画出1U的机位
	var rack_height = length * u_height;
	var rack_width = title_width;
	g.append('rect').attr('width', rack_width).attr('height', rack_height)
    .attr('x', object_x)
    .attr('y', object_y + title_height)
    .attr('fill', 'DarkSlateGray');
	
	
	
	for(var i = 0; i < length; i ++)
	{
	    var cur_y = u_height * i + title_height;
	    var cur_x = title_width / 10;

	    
	    g.append('rect').attr('width', u_width)
		.attr('height', u_height)
		.attr('stroke', 'black')
		.attr('stroke-width', '1')
		.attr('x', cur_x)
		.attr('y', cur_y)
		.attr('fill', 'gray');
	    
	    g.append('text').text(length - i)
		.attr('fill', 'white')
		.attr('x', title_width / 2)
		.attr('y', cur_y + u_height / 2 ) 
		.attr('text-anchor', 'middle')
		.attr('font-size', u_height + 'px')
		.attr('dy', 8);
	}
      </script>
    </div>
  </body>
</html>
