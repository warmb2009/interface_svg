<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>机柜管理</title>
    <!-- 新 Bootstrap 核心 CSS 文件 -->
    <link href="http://apps.bdimg.com/libs/bootstrap/3.3.0/css/bootstrap.min.css" rel="stylesheet">
    <!-- 可选的Bootstrap主题文件（一般不使用） -->
    <script src="http://apps.bdimg.com/libs/bootstrap/3.3.0/css/bootstrap-theme.min.css"></script>
    <!-- jQuery文件。务必在bootstrap.min.js 之前引入 -->
    <script src="http://apps.bdimg.com/libs/jquery/2.0.0/jquery.min.js"></script>
    <!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
    <script src="http://apps.bdimg.com/libs/bootstrap/3.3.0/js/bootstrap.min.js"></script>
    <script src="https://d3js.org/d3.v5.min.js"></script>
  </head>
  <body>
    <div class="row" style="background:lightgrey; border:1px solid grey;">

      <div  class="col-md-2">
	<div class="left-area" style="border=2px solid black; outline: 1px solid orange;">
	  <div class="cliente">
	    H700
	  </div>
	  <div class="cliente">
	    H900
	  </div>
	  <div class="cliente">
	    KDV7620
	  </div>
	  <div class="cliente">
	    KDV7610
	  </div>
	</div>
      </div>
      <div  class="col-md-6">
	<div class="left-area" style="border=2px solid black; outline: 1px solid orange;">
	  <div class="btn-toolbar">dsfasfd</div>
	  <svg width="960" height="600"></svg>
	  <script>

	    var zoom = d3.zoom()
		.scaleExtent([1, 10])
		.on("zoom", zoomed);

	    function zoomed() {
		d3.select(this).attr("transform", "translate(" + d3.event.transform.x + "," + d3.event.transform.y + ")scale(" + d3.event.transform.k + ")");
	    }
	    
	    //var u_rate = 550/43.5;
	    var length = 42;

	    
	    var title_width = 240;
	    var title_height = 30;
	    var title_color = 'dimgray';
	    
	    var u_width = title_width * 8 / 10;
	    var u_height = u_width / 443 * 43.5;
	    
	    var object_x = 0, object_y = 0;
	    
	    var svg = d3.select("svg");
	    var width = svg.attr("width");
	    var height = svg.attr("height");

	    var g = svg.append("g").call(zoom);

	    // 机柜名称部分
	    g.append('rect').attr('width', title_width / 10 - 2)
    .attr('height', title_height)
    .attr('fill', title_color)
    .attr('x', object_x)
    .attr('y', object_y); //左边小格
	    g.append('rect').attr('width', title_width / 10 * 8)
    .attr('height', title_height)
    .attr('fill', title_color)
    .attr('x', title_width / 10 + object_x)
    .attr('y', object_y);
	    g.append('rect').attr('width', title_width / 10 - 2)
    .attr('height', title_height)
    .attr('fill', title_color)
    .attr('x', 9 * title_width / 10 + 2 + object_x)
    .attr('y', object_y);
	    
	    var text = g.append('text').text('图腾机柜')
		.attr('fill', 'white')
		.attr('x', title_width / 2)
		.attr('y', title_height / 2)
		.attr('text-anchor', 'middle')
		.attr('font-size', title_height / 2 + 'px')
		.attr('dy', 8)

	    //画背景, 在背景之上画出1U的机位
	    var rack_height = length * u_height;
	    var rack_width = title_width;
	    g.append('rect').attr('width', rack_width).attr('height', rack_height)
    .attr('x', object_x)
    .attr('y', object_y + title_height)
    .attr('fill', 'DarkSlateGray');
	    
	    
	    
	    for(var i = 0; i < length; i ++)
	    {
		var cur_y = u_height * i + title_height;
		var cur_x = title_width / 10;

		
		g.append('rect').attr('width', u_width)
		    .attr('height', u_height)
		    .attr('stroke', 'black')
		    .attr('stroke-width', '1')
		    .attr('x', cur_x)
		    .attr('y', cur_y)
		    .attr('fill', 'gray');
		
		g.append('text').text(length - i)
		    .attr('fill', 'white')
		    .attr('x', title_width / 2)
		    .attr('y', cur_y + u_height / 2 ) 
		    .attr('text-anchor', 'middle')
		    .attr('font-size', u_height + 'px')
		    .attr('dy', 8);
		

		
		
		console.log(i);
	    }


	  </script>
	</div>
      </div>
    </div>
  </body>
</html>
